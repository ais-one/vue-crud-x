import{H as t,i as e,l as n,m as r,I as i,o,v as s,J as u,d as c,u as a,y as l,z as f,r as h,e as d,f as p,K as b,L as v,j as y,E as w,k as g,F as m,N as _}from"./vendor.f4e9483c.js";import{h as x,k as S}from"./index.ce429d1c.js";import{b as k,c as A,d as P,_ as E,e as I,f as R,g as j,h as T,i as C}from"./tslib.es6.d4493459.js";let O,N;const D=t=>{const e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r};function L(t){return"function"==typeof t}var M,F=((M=function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}}((function(t){Error.call(t),t.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),M.prototype.constructor=M,M);function W(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var U=function(){function t(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}var e;return t.prototype.unsubscribe=function(){var t,e,n,r,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=k(o),u=s.next();!u.done;u=s.next()){u.value.remove(this)}}catch(d){t={error:d}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}else o.remove(this);var c=this.initialTeardown;if(L(c))try{c()}catch(p){i=p instanceof F?p.errors:[p]}var a=this._teardowns;if(a){this._teardowns=null;try{for(var l=k(a),f=l.next();!f.done;f=l.next()){var h=f.value;try{G(h)}catch(b){i=null!=i?i:[],b instanceof F?i=A(A([],P(i)),P(b.errors)):i.push(b)}}}catch(v){n={error:v}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new F(i)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)G(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(e)}},t.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},t.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},t.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&W(e,t)},t.prototype.remove=function(e){var n=this._teardowns;n&&W(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function V(t){return t instanceof U||t&&"closed"in t&&L(t.remove)&&L(t.add)&&L(t.unsubscribe)}function G(t){L(t)?t():t.unsubscribe()}var H=void 0,J=!1,K=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return setTimeout.apply(void 0,A([],P(t)))};function z(t){K((function(){throw t}))}function Y(){}var q=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,V(e)&&e.add(n)):n.destination=X,n}return E(e,t),e.create=function(t,e,n){return new B(t,e,n)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(U),B=function(t){function e(e,n,r){var i,o=t.call(this)||this;if(L(e))i=e;else if(e){var s;i=e.next,n=e.error,r=e.complete,o&&J?(s=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:s=e,i=null==i?void 0:i.bind(s),n=null==n?void 0:n.bind(s),r=null==r?void 0:r.bind(s)}return o.destination={next:i?$(i):Y,error:$(null!=n?n:Q),complete:r?$(r):Y},o}return E(e,t),e}(q);function $(t,e){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{t.apply(void 0,A([],P(e)))}catch(r){z(r)}}}function Q(t){throw t}var X={closed:!0,next:Y,error:Q,complete:Y},Z="function"==typeof Symbol&&Symbol.observable||"@@observable";function tt(t){return t}function et(t){return 0===t.length?tt:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var nt=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r,i=(r=t)&&r instanceof q||function(t){return t&&L(t.next)&&L(t.error)&&L(t.complete)}(r)&&V(r)?t:new B(t,e,n),o=this.operator,s=this.source;return i.add(o?o.call(i,s):s?this._subscribe(i):this._trySubscribe(i)),i},t.prototype._deprecatedSyncErrorSubscribe=function(t){var e=t;e._syncErrorHack_isSubscribing=!0;var n=this.operator;if(n)t.add(n.call(t,this.source));else try{t.add(this._subscribe(t))}catch(i){e.__syncError=i}for(var r=e;r;){if("__syncError"in r)try{throw r.__syncError}finally{t.unsubscribe()}r=r.destination}e._syncErrorHack_isSubscribing=!1},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=rt(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(n){r(n),null==i||i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[Z]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length?et(t)(this):this},t.prototype.toPromise=function(t){var e=this;return new(t=rt(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function rt(t){var e;return null!==(e=null!=t?t:H)&&void 0!==e?e:Promise}function it(t){return function(e){if(function(t){return L(null==t?void 0:t.lift)}(e))return e.lift((function(e){try{return t(e,this)}catch(n){this.error(n)}}));throw new TypeError("Unable to lift unknown Observable type")}}var ot=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.onFinalize=o,s._next=n?function(t){try{n(t)}catch(r){e.error(r)}}:t.prototype._next,s._error=i?function(t){try{i(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:t.prototype._error,s._complete=r?function(){try{r()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,s}return E(e,t),e.prototype.unsubscribe=function(){var e,n=this.closed;t.prototype.unsubscribe.call(this),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))},e}(q),st=function(){return Date.now()},ut=function(t){function e(e,n){return t.call(this)||this}return E(e,t),e.prototype.schedule=function(t,e){return this},e}(U),ct=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return setInterval.apply(void 0,A([],P(t)))},at=function(t){return clearInterval(t)},lt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return E(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),ct(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return e;at(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n,r=!1;try{this.work(t)}catch(i){r=!0,n=!!i&&i||new Error(i)}if(r)return this.unsubscribe(),n},e.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,W(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(ut),ft=function(){function t(e,n){void 0===n&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(n,e)},t.now=st,t}(),ht=new(function(t){function e(e,n){void 0===n&&(n=ft.now);var r=t.call(this,e,n)||this;return r.actions=[],r._active=!1,r._scheduled=void 0,r}return E(e,t),e.prototype.flush=function(t){var e=this.actions;if(this._active)e.push(t);else{var n;this._active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(ft))(lt);var dt=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};var pt="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function bt(t){if(t instanceof nt)return t;if(null!=t){if(function(t){return L(t[Z])}(t))return i=t,new nt((function(t){var e=i[Z]();if(L(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(dt(t))return vt(t);if(L(null==(r=t)?void 0:r.then))return n=t,new nt((function(t){n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,z)}));if(function(t){return Symbol.asyncIterator&&L(null==t?void 0:t[Symbol.asyncIterator])}(t))return yt(t);if(function(t){return L(null==t?void 0:t[pt])}(t))return e=t,new nt((function(t){var n,r;try{for(var i=k(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()}));if(function(t){return L(null==t?void 0:t.getReader)}(t))return yt(function(t){return I(this,arguments,(function(){var e,n,r;return R(this,(function(i){switch(i.label){case 0:e=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,j(e.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,j(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,j(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}}))}))}(t))}var e,n,r,i;throw function(t){return new TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(t)}function vt(t){return new nt((function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()}))}function yt(t){return new nt((function(e){(function(t,e){var n,r,i,o;return T(this,void 0,void 0,(function(){var s,u;return R(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=C(t),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,e.next(s),e.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=c.sent(),i={error:u},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}}))}))})(t,e).catch((function(t){return e.error(t)}))}))}function wt(t,e){return e?function(t,e){return new nt((function(n){var r=0;return e.schedule((function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())}))}))}(t,e):vt(t)}function gt(t,e){return it((function(n,r){var i=0;n.subscribe(new ot(r,(function(n){r.next(t.call(e,n,i++))})))}))}var mt=Array.isArray;function _t(t){return gt((function(e){return function(t,e){return mt(e)?t.apply(void 0,A([],P(e))):t(e)}(t,e)}))}function xt(t,e,n){return void 0===n&&(n=1/0),L(e)?xt((function(n,r){return gt((function(t,i){return e(n,t,r,i)}))(bt(t(n,r)))}),n):("number"==typeof e&&(n=e),it((function(e,r){return function(t,e,n,r,i,o,s,u){var c=[],a=0,l=0,f=!1,h=function(){!f||c.length||a||e.complete()},d=function(t){return a<r?p(t):c.push(t)},p=function(t){o&&e.next(t),a++;var u=!1;bt(n(t,l++)).subscribe(new ot(e,(function(t){null==i||i(t),o?d(t):e.next(t)}),(function(){u=!0}),void 0,(function(){if(u)try{a--;for(var t=function(){var t=c.shift();s?e.add(s.schedule((function(){return p(t)}))):p(t)};c.length&&a<r;)t();h()}catch(n){e.error(n)}})))};return t.subscribe(new ot(e,d,(function(){f=!0,h()}))),function(){null==u||u()}}(e,r,t,n)})))}var St=["addListener","removeListener"],kt=["addEventListener","removeEventListener"],At=["on","off"];function Pt(t,e,n,r){if(L(n)&&(r=n,n=void 0),r)return Pt(t,e,n).pipe(_t(r));var i=P(function(t){return L(t.addEventListener)&&L(t.removeEventListener)}(t)?kt.map((function(r){return function(i){return t[r](e,i,n)}})):function(t){return L(t.addListener)&&L(t.removeListener)}(t)?St.map(Et(t,e)):function(t){return L(t.on)&&L(t.off)}(t)?At.map(Et(t,e)):[],2),o=i[0],s=i[1];if(!o&&dt(t))return xt((function(t){return Pt(t,e,n)}))(wt(t));if(!o)throw new TypeError("Invalid event target");return new nt((function(t){var e=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1<e.length?e:e[0])};return o(e),function(){return s(e)}}))}function Et(t,e){return function(n){return function(r){return t[n](e,r)}}}function It(t,e){return t===e}const Rt={name:"DemoMain",setup(l,f){const h=t([1,2,3]),d=e([]);console.log("provide-inject MyTheme",n("MyTheme"));const p=a(),b=e(0);let v=10;const y=e(20),w=e(null),g=e(""),m=e(""),_=e({a:10,b:20,c:30}),k=t({a:{xx:40},b:50,c:60}),A=r((()=>p.state.count)),P=r((()=>p.state.user));i((()=>{d.value=[]}));let E;o((async()=>{var t,e,n,r,i,o;console.log("demomain mounted!"),E=setInterval((()=>{console.log("timer fired"),v+=1,y.value+=1}),2e5),Pt(w.value.$el,"input").pipe((i=1e3,void 0===o&&(o=ht),it((function(t,e){var n=null,r=null,s=null,u=function(){if(n){n.unsubscribe(),n=null;var t=r;r=null,e.next(t)}};function c(){var t=s+i,e=o.now();e<t?n=this.schedule(void 0,t-e):u()}t.subscribe(new ot(e,(function(t){r=t,s=o.now(),n||(n=o.schedule(c,i))}),(function(){u(),e.complete()}),void 0,(function(){r=n=null})))}))),gt((t=>t.target.value)),(void 0===r&&(r=tt),n=null!=n?n:It,it((function(t,e){var i,o=!0;t.subscribe(new ot(e,(function(t){var s=r(t);!o&&n(i,s)||(o=!1,i=s,e.next(t))})))}))),(t=t=>fetch("https://swapi.dev/api/people/?search="+t+"&format=json").then((t=>t.json())).then((t=>t)),it((function(n,r){var i=null,o=0,s=!1,u=function(){return s&&!i&&r.complete()};n.subscribe(new ot(r,(function(n){null==i||i.unsubscribe();var s=0,c=o++;bt(t(n,c)).subscribe(i=new ot(r,(function(t){return r.next(e?e(n,t,c,s++):t)}),(function(){i=null,u()})))}),(function(){s=!0,u()})))})))).subscribe((t=>{m.value=JSON.stringify(t),console.log(t)}))})),s((()=>{E&&clearInterval(E)})),u((()=>console.log("demomain updated!"))),c((()=>console.log("demomain unmounted!")));return{testObjectReactive:k,testObjectRef:_,makeRef:(t,e)=>{d[e]=t},list:h,divs:d,nonReactiveData:v,reactiveData:y,count:b,storeCount:A,storeUser:P,testApi:async t=>{try{const{data:e}=await x.get("/api/"+t);console.log("testApi",e)}catch(e){console.log("testApi err",e)}},subPn:async()=>{console.log(S);try{let t;if("FCM"===S)t=await(async(t,e)=>{try{const n=await Notification.requestPermission();if("granted"!==n)return null;if(O||(O=firebase.initializeApp(window.CONFIG_FIREBASE_CLIENT)),N||(N=firebase.messaging(),N.useServiceWorker(t),N.usePublicVapidKey(window.CONFIG_VAPID_KEY),N.onTokenRefresh((async()=>{const t=await N.getToken();await e(t)})),N.onMessage((t=>{console.log("Message received. ",t);try{const{title:e,body:n}=JSON.parse(t.data.notification);console.log((new Date).toISOString(),e,n)}catch(e){console.log("GCM msg error",e.toString())}}))),"granted"===n)return await N.getToken()}catch(n){console.log("Error initialise firebase app",n.toString())}return null})(window.SW_REG,(async t=>{await x.post("/api/webpush/sub",{subscription:t})}));else if("Webpush"===S){const{data:e}=await x.get("/api/webpush/vapid-public-key");t=await(async t=>{const e=await navigator.serviceWorker.ready,n=D(t);let r=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n});return r=JSON.stringify(r),console.log("subscription",r),r})(e.publicKey)}t&&await x.post("/api/webpush/sub",{subscription:t})}catch(t){console.log("subPn",t)}},unsubPn:async()=>{try{"Webpush"===S&&await(async()=>{const t=await navigator.serviceWorker.ready,e=await t.pushManager.getSubscription();e&&await e.unsubscribe()})(),await x.post("/api/webpush/unsub")}catch(t){console.log("unsubPn",t)}},testPn:async()=>{try{let t;console.log("testPn VITE_PWA_PN",S),"FCM"===S?t={title:"Hello",body:(new Date).toLocaleString()}:"Webpush"===S&&(t="Hello "+(new Date).toLocaleString()),console.log("testPn data",t),await x.post("/api/webpush/send/1",{mode:S,data:t})}catch(t){console.log("testPn",t)}},searchRef:w,searchVal:g,searchResult:m}}},jt=m();l("data-v-08320e7e");const Tt={class:"container"},Ct=y("h1",null,"Site A - Test VueJS 3",-1),Ot=_('<div class="section" data-v-08320e7e><div class="box" style="background-color:red;" data-v-08320e7e>A</div><div class="box" style="background-color:lightblue;" data-v-08320e7e>B</div><div class="box" style="background-color:yellow;" data-v-08320e7e>C</div><div class="box" style="background-color:brown;" data-v-08320e7e>D</div><div class="box" style="background-color:lightgreen;" data-v-08320e7e>E</div><div class="box" style="background-color:red;" data-v-08320e7e>A</div><div class="box" style="background-color:brown;" data-v-08320e7e>G</div></div>',1),Nt=g(),Dt=y("h2",null,"Test Push Notifications",-1),Lt=g(" "),Mt=g(" "),Ft=y("h2",null,"Test Search and rxjs",-1),Wt=y("h2",null,"Test Reactivity In Object",-1),Ut=g(" Click to see increment. Also check console.log if onUpdated is called ");f();const Vt=jt(((t,e,n,r,i,o)=>{const s=h("a-input");return d(),p("div",Tt,[Ct,(d(!0),p(b,null,v(r.list,((t,e)=>(d(),p("div",{key:e,ref:t=>r.divs[e]=t},w(t),513)))),128)),Ot,y("p",null,[y("span",null,"Count is: "+w(r.count),1),y("button",{onClick:e[1]||(e[1]=t=>r.count++)},"increment")]),y("p",null,[y("button",{onClick:e[2]||(e[2]=t=>r.testApi("healthcheck"))},"Test API"),Nt,y("button",{onClick:e[3]||(e[3]=t=>r.testApi("health-auth"))},"Test API Auth")]),y("p",null,"Non-Reactive Data: "+w(r.nonReactiveData),1),y("p",null,"Reactive Data: "+w(r.reactiveData),1),y("p",null,"Vuex Store "+w(r.storeCount)+" - "+w(r.storeUser),1),Dt,y("p",null,[y("button",{onClick:e[4]||(e[4]=(...t)=>r.subPn&&r.subPn(...t))},"Sub PN"),Lt,y("button",{onClick:e[5]||(e[5]=(...t)=>r.unsubPn&&r.unsubPn(...t))},"Unsub PN"),Mt,y("button",{onClick:e[6]||(e[6]=(...t)=>r.testPn&&r.testPn(...t))},"Test PN")]),Ft,y(s,{ref:"searchRef",placeholder:"rxjs search swapi"},null,512),g(" "+w(r.searchResult||"No Search Result")+" ",1),Wt,y("p",null,[Ut,y("button",{onClick:e[7]||(e[7]=()=>r.testObjectRef.a++)},"Test Object Ref = "+w(r.testObjectRef.a),1),y("button",{onClick:e[8]||(e[8]=()=>r.testObjectReactive.a.xx++)},"Test Object Reactive = "+w(r.testObjectReactive.a.xx),1)]),y("ul",null,[(d(),p(b,null,v(10,(t=>y("li",{key:t},w(t),1))),64))])])}));Rt.render=Vt,Rt.__scopeId="data-v-08320e7e";export default Rt;
